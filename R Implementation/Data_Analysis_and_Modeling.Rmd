---
title: "Data analysis and modeling"
author: "Usman Matheen"
date: "2024-07-10"
output: html_document
---

```{r}
install.packages("googledrive")
install.packages("readr")
library(readr)
library(googledrive)
```

```{r}
# Your Google Drive file URL
file_url <- "https://drive.google.com/file/d/1ENtG3huMNMBMekluWXfYlAGHWXSkQiLC/view?usp=sharing"

# Get the file ID from the URL
file_id <- drive_get(as_id(file_url))

# Download the file to a temporary location
drive_download(as_id(file_id), path = "transformed_data.csv", overwrite = TRUE)

# Load the transformed data
transformed_data <- read.csv("transformed_data.csv")
```


```{r}
# Load necessary libraries
library(ggplot2)
library(dplyr)

# Load the transformed data
#transformed_data <- read.csv("C:/Users/usman/OneDrive - Illinois Institute of #Technology/DPA/Project/Divvy data/transformed_data.csv")

# Violin Plot for Member Type vs Trip Duration
ggplot(transformed_data, aes(x = member_casual, y = trip_duration)) +
  geom_violin(fill = "steelblue", alpha = 0.7) +
  labs(
    title = "Violin Plot of Trip Duration by Member Type",
    x = "Member Type",
    y = "Trip Duration (minutes)"
  ) +
  theme_minimal()
```

```{r}
# Rug Plot of Trip Duration
ggplot(transformed_data, aes(x = trip_duration)) +
  geom_rug(sides = "b", color = "steelblue") +
  labs(
    title = "Rug Plot of Trip Duration",
    x = "Trip Duration (minutes)",
    y = "Density"
  ) +
  theme_minimal()
```


```{r}
numeric_columns <- transformed_data %>%
  select(trip_duration, start_hour) %>%
  na.omit()

ggpairs(numeric_columns) +
  labs(title = "Scatterplot Matrix for Time Duration") +
  theme_minimal()

```


```{r}
# Member vs Casual Riders by Ride Type for Each Month
ggplot(transformed_data, aes(x = start_month, fill = member_casual)) +
  geom_bar(position = "dodge") +
  labs(
    title = "Member vs Casual Riders by Ride Type for Each Month",
    x = "Month",
    y = "Count",
    fill = "Member Type"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
```{r}
# Member vs Casual Riders by Seasons
ggplot(transformed_data, aes(x = season, fill = member_casual)) +
  geom_bar(position = "dodge") +
  labs(
    title = "Member vs Casual Riders by Seasons",
    x = "Season",
    y = "Count",
    fill = "Member Type"
  ) +
  theme_minimal()
```

```{r}
# Time of Day Distribution
ggplot(transformed_data, aes(x = time_of_day)) +
  geom_bar(fill = "steelblue") +
  labs(
    title = "Distribution of Trips by Time of Day",
    x = "Time of Day",
    y = "Count"
  ) +
  theme_minimal()
```

```{r}
# Starting Station Distribution (Top 10)
top_start_stations <- transformed_data %>%
  count(start_station_name, sort = TRUE) %>%
  top_n(10, wt = n)

ggplot(top_start_stations, aes(x = reorder(start_station_name, n), y = n)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  coord_flip() +
  labs(
    title = "Top 10 Starting Stations",
    x = "Start Station",
    y = "Count"
  ) +
  theme_minimal()
```

```{r}
# End Station Distribution (Top 10)
top_end_stations <- transformed_data %>%
  count(end_station_name, sort = TRUE) %>%
  top_n(10, wt = n)

ggplot(top_end_stations, aes(x = reorder(end_station_name, n), y = n)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  coord_flip() +
  labs(
    title = "Top 10 Ending Stations",
    x = "End Station",
    y = "Count"
  ) +
  theme_minimal()
```


